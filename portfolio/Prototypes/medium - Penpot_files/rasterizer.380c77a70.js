(function(){
'use strict';var ICb=function(a){return PENPOT.Pw(function(b){var c=new Image;PENPOT.Dv(c,"onload",function(){b.next(c);return b.complete()});PENPOT.Dv(c,"crossOrigin","anonymous");PENPOT.Dv(c,"onerror",function(d){return b.error(d)});PENPOT.Dv(c,"onabort",function(){return b.error(PENPOT.Eh("operation aborted",PENPOT.ni.U(PENPOT.w([new PENPOT.k(null,3,[PENPOT.qi,PENPOT.aRa,PENPOT.Zn,PENPOT.bRa,PENPOT.ar,"operation aborted"],null),null])),null))});PENPOT.Dv(c,"src",a);return function(){PENPOT.Dv(c,
"src","");PENPOT.Dv(c,"onload",null);PENPOT.Dv(c,"onerror",null);return PENPOT.Dv(c,"onabort",null)}})},JCb=function(a,b,c){var d=a/b;return a<b?new PENPOT.K(null,2,5,PENPOT.M,[c,1/d*c],null):new PENPOT.K(null,2,5,PENPOT.M,[c*d,c],null)},LCb=function(a){if(PENPOT.m(KCb.has(a))){var b=KCb.get(a);return PENPOT.Rw(b.text())}return PENPOT.bx(function(c){return null==c?(0,PENPOT.yx)(a):PENPOT.hx(function(d){return KCb.set(a,PENPOT.fRa(d,"text/plain"))},PENPOT.bx(PENPOT.eRa,(0,PENPOT.yx)(PENPOT.kk.j(c))))},
PENPOT.gx(function(c){if(PENPOT.xv("app.rasterizer",PENPOT.Rk)){var d=function(){return new PENPOT.jh(function(){return new PENPOT.K(null,1,5,PENPOT.M,[new PENPOT.K(null,2,5,PENPOT.M,[PENPOT.ar,"fetching data uri"],null)],null)})}(),e=PENPOT.zv();PENPOT.uv(function(){var f=PENPOT.p(d),h=PENPOT.cg.J(PENPOT.zy,f);f=PENPOT.cw.j(PENPOT.ni.U(PENPOT.w([null,null])));var l=new PENPOT.k(null,7,[PENPOT.Ay,f,PENPOT.By,e,PENPOT.Cy,h,PENPOT.Dy,(0,PENPOT.Ey)(),PENPOT.Fy,new PENPOT.jh(function(){return PENPOT.yv(h)}),
PENPOT.Gy,"app.rasterizer",PENPOT.Hy,PENPOT.Rk],null);f=function(){return null!=c?PENPOT.J.U(l,PENPOT.aG,c,PENPOT.w([PENPOT.bG,new PENPOT.jh(function(){return c.stack})])):l}();return PENPOT.qh.J(PENPOT.Iy,PENPOT.We(f))})}return(0,PENPOT.yx)(null)},PENPOT.Fx(new PENPOT.k(null,5,[PENPOT.zx,a,PENPOT.Dx,PENPOT.EL,PENPOT.Tl,PENPOT.Nx,PENPOT.wt,PENPOT.yRa,PENPOT.zRa,!0],null))))},MCb=function(a){var b=PENPOT.rx(a,"href");return PENPOT.m(b)?PENPOT.dj(b,"data:")?(0,PENPOT.yx)(a):PENPOT.$w(function(c){PENPOT.vx(a,
"href",c);return a},LCb(b)):PENPOT.Sw()},NCb=function(a,b){var c=a.documentElement;var d=a.createElementNS("http://www.w3.org/2000/svg","style");PENPOT.sx(d,a.createTextNode(b));return PENPOT.sx(c,d)},OCb=function(a){return PENPOT.ex(function(b,c){var d=PENPOT.x(c,0,null);c=PENPOT.x(c,1,null);return PENPOT.ij(b,d,c)},a,PENPOT.bx(function(b){return PENPOT.$w(function(c){return new PENPOT.K(null,2,5,PENPOT.M,[b,c],null)},LCb(b))},PENPOT.$w(PENPOT.Xc,PENPOT.Rw(PENPOT.Xg(/url\((https?:\/\/[^)]+)\)/,a)))))},
PCb=function(a){return PENPOT.jx(PENPOT.bx(function(b){var c=PENPOT.rx(b,"style");return PENPOT.hx(function(d){return PENPOT.vx(b,"style",d)},OCb(c))},PENPOT.Rw(PENPOT.tx(a,"[style]"))))},QCb=function(a){return PENPOT.jx(PENPOT.bx(function(b){return PENPOT.hx(function(c){return PENPOT.iRa(b,c)},OCb(null!=b?b.textContent:null))},PENPOT.Rw(PENPOT.tx(a,"style"))))},RCb=function(a,b){return(0,PENPOT.Jx)(PENPOT.jx(PENPOT.bx(MCb,PENPOT.Rw(PENPOT.tx(a,"image")))),PENPOT.jx(PENPOT.hx(PENPOT.Xe(NCb,a),OCb(b))),
PCb(a),QCb(a),(0,PENPOT.yx)(a))},SCb=function(a){return(new DOMParser).parseFromString(a,"image/svg+xml")},TCb=function(a){a=a.documentElement;return(new XMLSerializer).serializeToString(a)},UCb=function(a,b,c){a=SCb(a);return PENPOT.$w(TCb,PENPOT.$w(function(d){var e=d.documentElement;var f=d.documentElement;var h=PENPOT.rx(f,"width");f=PENPOT.rx(f,"height");PENPOT.Uj(h,f)?(f=d.documentElement,h=PENPOT.rx(f,"width"),f=PENPOT.rx(f,"height"),h=JCb(PENPOT.Qj(h,0),PENPOT.Qj(f,0),c)):(h=PENPOT.rx(d.documentElement,
"viewBox"),"string"===typeof h?(f=PENPOT.jj(h,/\s+/),PENPOT.x(f,0,null),PENPOT.x(f,1,null),h=PENPOT.x(f,2,null),f=PENPOT.x(f,3,null),h=JCb(PENPOT.Qj(h,0),PENPOT.Qj(f,0),c)):h=null);f=h;h=PENPOT.x(f,0,null);f=PENPOT.x(f,1,null);PENPOT.vx(e,"width",""+(h??""));PENPOT.vx(e,"height",""+(f??""));return d},RCb(a,b)))},VCb=function(a){return PENPOT.Pw(function(b){var c=PENPOT.AD.createElement("canvas");c.width=a.width;c.height=a.height;c.getContext("bitmaprenderer").transferFromImageBitmap(a);c.toBlob(function(d){b.next(d);
return b.complete()});return PENPOT.We(null)})},WCb=function(a){var b=PENPOT.Tj(a.width,300),c=PENPOT.Tj(a.quality,"medium");return PENPOT.bx(function(d){return PENPOT.hx(function(){return PENPOT.gRa(d)},PENPOT.bx(function(e){var f={resizeWidth:b,resizeQuality:c};var h=e.width;var l=e.height;if("OffscreenCanvas"in window)h=new OffscreenCanvas(h,l);else{var q=document.createElement("canvas");PENPOT.Dv(q,"width",h);PENPOT.Dv(q,"height",l);h=q}h.getContext("2d").drawImage(e,0,0);return createImageBitmap(h,
f)},ICb(d)))},PENPOT.$w(PENPOT.nx,PENPOT.$w(function(d){return PENPOT.fRa(d,"image/svg+xml")},UCb(a.data,a.styles,b))))},$Cb=function(a){var b=a.data;if(PENPOT.dj(XCb,a.origin)){var c=b.id;a=b.payload;b=b.scope;if(null!=a&&PENPOT.v.J(b,"penpot/rasterizer")){b=PENPOT.Xe(YCb,c);c=PENPOT.Xe(ZCb,c);a:switch(PENPOT.Tj(a.result,"blob")){case "image-bitmap":a=WCb(a);break a;default:a=PENPOT.bx(VCb,WCb(a))}a=PENPOT.NQa(a,b,c)}else a=null;return a}return null},aDb=function(a,b,c){a={id:a,type:b,scope:"penpot/rasterizer",
payload:c};return window===parent?null:c instanceof ImageBitmap?parent.postMessage(a,XCb,[c]):parent.postMessage(a,XCb)},YCb=function(a,b){return aDb(a,"success",b)},ZCb=function(a,b){return aDb(a,"failure",PENPOT.Hh(b))},cDb=function(){window.addEventListener("message",$Cb);aDb(null,"ready",null);if(PENPOT.xv("app.rasterizer",PENPOT.hk)){var a=function(){return new PENPOT.jh(function(){return new PENPOT.K(null,3,5,PENPOT.M,[new PENPOT.K(null,2,5,PENPOT.M,[PENPOT.ar,"initialized"],null),new PENPOT.K(null,
2,5,PENPOT.M,[PENPOT.etb,""+(PENPOT.Qx??"")],null),new PENPOT.K(null,2,5,PENPOT.M,[bDb,""+(XCb??"")],null)],null)})}(),b=PENPOT.zv();PENPOT.uv(function(){var c=PENPOT.p(a),d=PENPOT.cg.J(PENPOT.zy,c);c=PENPOT.cw.j(PENPOT.ni.U(PENPOT.w([null,null])));c=new PENPOT.k(null,7,[PENPOT.Ay,c,PENPOT.By,b,PENPOT.Cy,d,PENPOT.Dy,(0,PENPOT.Ey)(),PENPOT.Fy,new PENPOT.jh(function(){return PENPOT.yv(d)}),PENPOT.Gy,"app.rasterizer",PENPOT.Hy,PENPOT.hk],null);return PENPOT.qh.J(PENPOT.Iy,PENPOT.We(c))})}return null},
bDb=new PENPOT.C(null,"parent-uri","parent-uri",-371819908);PENPOT.ab("rasterizer");PENPOT.wv.set("app.rasterizer",PENPOT.vv(PENPOT.hk));var KCb=new Map,XCb=""+(PENPOT.Qx??"");PENPOT.pa("app.rasterizer.init",cDb);PENPOT.lb();cDb();
}).call(this);
//# sourceMappingURL=rasterizer.380c77a70.js.map
